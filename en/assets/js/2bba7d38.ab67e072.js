"use strict";(self.webpackChunkathenaserving=self.webpackChunkathenaserving||[]).push([[9937],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(67294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,s=function(e,n){if(null==e)return{};var t,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var i=a.createContext({}),d=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=d(e.components);return a.createElement(i.Provider,{value:n},e.children)},c="mdxType",_={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,s=e.mdxType,r=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=d(t),p=s,m=c["".concat(i,".").concat(p)]||c[p]||_[p]||r;return t?a.createElement(m,o(o({ref:n},u),{},{components:t})):a.createElement(m,o({ref:n},u))}));function m(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var r=t.length,o=new Array(r);o[0]=p;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[c]="string"==typeof e?e:s,o[1]=l;for(var d=2;d<r;d++)o[d]=t[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},42982:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>_,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var a=t(87462),s=(t(67294),t(3905));const r={sidebar_position:1,sidebar_label:"\u6982\u8ff0"},o=void 0,l={unversionedId:"\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b/\u6982\u8ff0",id:"\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b/\u6982\u8ff0",title:"\u6982\u8ff0",description:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v1.0",source:"@site/docs/\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b/\u6982\u8ff0.md",sourceDirName:"\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b",slug:"/\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b/\u6982\u8ff0",permalink:"/en/docs/\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b/\u6982\u8ff0",draft:!1,editUrl:"https://github.com/zhangyongtian/bigdataknowledge/tree/dev/docs/\u9879\u76ee\u5b9e\u6218\u6848\u4f8b/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b/\u6982\u8ff0.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"\u6982\u8ff0"},sidebar:"docSidebar",previous:{title:"\u6d41\u6279\u4e00\u4f53\u6848\u4f8b",permalink:"/en/docs/category/\u6d41\u6279\u4e00\u4f53\u6848\u4f8b"},next:{title:"FAQ",permalink:"/en/docs/faq"}},i={},d=[{value:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v1.0",id:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v10",level:2},{value:"\u7f3a\u70b9",id:"\u7f3a\u70b9",level:3},{value:"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v2.0",id:"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v20",level:2},{value:"\u7f3a\u70b9",id:"\u7f3a\u70b9-1",level:3},{value:"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v3.0\uff08\u6d41\u6279\u4e00\u4f53\u67b6\u6784\uff09",id:"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v30\u6d41\u6279\u4e00\u4f53\u67b6\u6784",level:2},{value:"\u6570\u636e\u6d41\u8f6c\u56fe",id:"\u6570\u636e\u6d41\u8f6c\u56fe",level:3},{value:"\u4f18\u70b9",id:"\u4f18\u70b9",level:3},{value:"\u7f3a\u70b9",id:"\u7f3a\u70b9-2",level:3},{value:"\u6280\u672f\u9009\u578b",id:"\u6280\u672f\u9009\u578b",level:3},{value:"\u67b6\u6784",id:"\u67b6\u6784",level:2},{value:"\u5b9e\u6218",id:"\u5b9e\u6218",level:2},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:3},{value:"Flink CDC \u6570\u636e\u91c7\u96c6",id:"flink-cdc-\u6570\u636e\u91c7\u96c6",level:3},{value:"\u7ef4\u8868\u6570\u636e\u4e0b\u6c89\u5230Paimon",id:"\u7ef4\u8868\u6570\u636e\u4e0b\u6c89\u5230paimon",level:3},{value:"Flink CDC \u63a5\u5165MySQL\u6570\u636e\u5230Kafka",id:"flink-cdc-\u63a5\u5165mysql\u6570\u636e\u5230kafka",level:3},{value:"Kafka\u6570\u636e\u540c\u6b65\u5230Paimon\u7684ods\u5c42",id:"kafka\u6570\u636e\u540c\u6b65\u5230paimon\u7684ods\u5c42",level:3},{value:"\u6d41\u6279\u4e00\u4f53\u5904\u7406",id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406",level:3},{value:"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWD\u5c42(kafka)",id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dwd\u5c42kafka",level:4},{value:"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWS\u5c42(kafka)",id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dws\u5c42kafka",level:4},{value:"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWD\u5c42(paimon)",id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dwd\u5c42paimon",level:4},{value:"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWS\u5c42(paimon)",id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dws\u5c42paimon",level:4},{value:"\u7ed3\u679c\u5bfc\u5165StarRocks",id:"\u7ed3\u679c\u5bfc\u5165starrocks",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}],u={toc:d},c="wrapper";function _(e){let{components:n,...r}=e;return(0,s.kt)(c,(0,a.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h2",{id:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v10"},"\u57fa\u672c\u521d\u521b\u516c\u53f8\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v1.0"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u67b6\u6784",src:t(46634).Z,width:"1193",height:"425"})),(0,s.kt)("h3",{id:"\u7f3a\u70b9"},"\u7f3a\u70b9"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Debezium \u4ec5\u80fd\u5355\u673a\u90e8\u7f72\uff0c\u53ea\u80fd\u5355\u5e76\u53d1\u8bfb\u53d6binlog\u65e5\u5fd7\u3002"),(0,s.kt)("li",{parentName:"ul"},"Clickhouse\u5b58\u50a8\u7684\u662f\u5927\u91cf\u7684\u660e\u7ec6\u6570\u636e\uff0c\u4f1a\u5bfc\u81f4Clickhouse\u53d8\u5f97\u81c3\u80bf\u3002"),(0,s.kt)("li",{parentName:"ul"},"Pulsar\u4e0eClickhouse\u4e4b\u95f4\u7f3a\u5c11\u6570\u636e\u5904\u7406\u7684\u8fc7\u7a0b\u3002"),(0,s.kt)("li",{parentName:"ul"},"Clickhouse\u5355\u8868\u6027\u80fd\u5f3a\u52b2\uff0c\u4f46\u662f\u591a\u8868join\u6027\u80fd\u5dee\u3002")),(0,s.kt)("h2",{id:"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v20"},"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v2.0"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u67b6\u6784",src:t(47271).Z,width:"1235",height:"408"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Flink CDC\u901a\u8fc7\u8bfb\u53d6Mysql\u6570\u636e\u5e93\u7684Binlog\u65e5\u5fd7\uff0c\u5b9e\u65f6\u6355\u83b7\u6570\u636e\u53d8\u66f4\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u4f7f\u7528Hudi on Hive \u4f1a\u5c06ODS\u5c42\u6e90\u6570\u636e\u4fe1\u606f\u81ea\u52a8\u540c\u6b65\u5230Hive\u4e2d\uff0c\u4fbf\u4e8e\u7ba1\u7406\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u4f7f\u7528Flink SQL\u5c06Hudi\u7684ODS\u5c42\u6570\u636e\u62c9\u5bbd\u5199\u5165\u5230Hudi\u7684DWD\u5c42\uff0c\u4fbf\u4e8e\u540e\u7eed\u7684\u6570\u4ed3\u5efa\u6a21\u3002"),(0,s.kt)("li",{parentName:"ul"},"DWD\u5c42\u901a\u8fc7join\u548c\u8f7b\u5ea6\u805a\u5408\u8fdb\u5165DWS\u5c42\u53ef\u76f4\u63a5\u7528\u4e8eBI\u62a5\u8868\u3002")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u67b6\u6784",src:t(45611).Z,width:"986",height:"464"})),(0,s.kt)("h3",{id:"\u7f3a\u70b9-1"},"\u7f3a\u70b9"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u901a\u8fc7Hudi\u4ec5\u80fd\u5b9e\u73b0\u51c6\u5b9e\u65f6Hudi\u5ef6\u8fdf\u8f83\u9ad8\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u6d41\u5f0f\u65e5\u5fd7\u6570\u636e\u672a\u7eb3\u5165\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u5f00\u6e90\u7ec4\u4ef6\u7ef4\u62a4\u4e0d\u65b9\u4fbf\u3002")),(0,s.kt)("h2",{id:"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v30\u6d41\u6279\u4e00\u4f53\u67b6\u6784"},"\u5927\u6570\u636e\u5e73\u53f0\u67b6\u6784v3.0\uff08\u6d41\u6279\u4e00\u4f53\u67b6\u6784\uff09"),(0,s.kt)("h3",{id:"\u6570\u636e\u6d41\u8f6c\u56fe"},"\u6570\u636e\u6d41\u8f6c\u56fe"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u67b6\u6784",src:t(58142).Z,width:"1473",height:"491"})),(0,s.kt)("h3",{id:"\u4f18\u70b9"},"\u4f18\u70b9"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"\u4e3b\u8981\u7684\u4f18\u70b9\u662f\u5f25\u8865Kappa\u67b6\u6784\u6570\u636e\u6cbb\u7406\u8fd8\u6709\u6279\u5904\u7406\u7684\u95ee\u9898\uff0c\u5b9e\u65f6\u8fd8\u662f\u5728\u6d88\u606f\u7cfb\u7edf\u91cc\u9762\uff0c\u4f46\u662f\u6570\u636e\u7684\u5b58\u50a8\u662f\u4fdd\u5b58\u5728\u4e86Paimon\u6570\u636e\u6e56\u4e2d\uff0c\u8fd9\u6837\u6d41\u8ba1\u7b97\u5b8c\u4ee5\u540e\uff0c\u8fd8\u80fd\u4fdd\u5b58\u4e0b\u6765\u63d0\u4f9b\u7ed9\u6279\u5904\u7406\u6267\u884c\u3002")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"\u5904\u7406\u901f\u5ea6\u76f8\u5bf9\u4e0a\u9762\u7684\u51e0\u79cd\u67b6\u6784\u8981\u5feb\uff0c\u56e0\u4e3a\u6279\u5904\u7406\u662f\u5728\u6570\u636e\u6e56\u91cc\u9762\uff0c\u6570\u636e\u6e56\u91cc\u9762\u6709\u5927\u91cf\u7684\u6570\u636e\uff0c\u6279\u5904\u7406\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u6570\u636e\uff0c\u6240\u4ee5\u901f\u5ea6\u4f1a\u5feb\u4e00\u4e9b\u3002")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\uff0c\u6279\u5904\u7406\u7684\u7ed3\u679c\u53ef\u4ee5\u4f5c\u4e3a\u6d41\u5904\u7406\u7684\u8f93\u5165\uff0c\u8fd9\u6837\u5c31\u5f62\u6210\u4e86\u6d41\u6279\u4e00\u4f53\u3002"))),(0,s.kt)("h3",{id:"\u7f3a\u70b9-2"},"\u7f3a\u70b9"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u6570\u636e\u6e56\u6765\u8bf4\uff0c\u6309\u73b0\u5728\u7684\u60c5\u51b5\u8fd8\u662f\u5bf9\u4e8e\u6570\u636e\u4ed3\u5e93\u7684\u652f\u6301\u6709\u4e00\u4e9b\u6b20\u7f3a\uff0c\u6570\u636e\u4ed3\u5e93\u7684\u4e00\u4e2a\u91cd\u70b9\u662f\u4fdd\u5b58\u5386\u53f2\u6570\u636e\uff0c",(0,s.kt)("strong",{parentName:"li"},"\u4f46\u662f\u6570\u636e\u6e56\u662f\u4fdd\u5b58\u539f\u59cb\u6570\u636e\u7684\u526f\u672c\uff0c\u90a3\u4e48\u76f8\u5bf9\u6765\u8bf4\u5c31\u4f1a\u5c11\u4e86\u4e00\u4e9b\u6570\u636e\u53d8\u66f4\u7684\u6570\u636e\u5b58\u50a8"),"\uff0c\u8fd9\u6837\u6570\u636e\u6e56\u7684\u6570\u636e\u5b58\u50a8\uff0c\u76f8\u5bf9\u4e8e\u6570\u636e\u4ed3\u5e93\u6765\u8bf4\uff0c\u4f1a\u5c11\u4e00\u4e9b\u3002")),(0,s.kt)("h3",{id:"\u6280\u672f\u9009\u578b"},"\u6280\u672f\u9009\u578b"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Flink CDC \u5b9e\u73b0\u6570\u636e\u5b9e\u65f6\u91c7\u96c6\u3002"),(0,s.kt)("li",{parentName:"ul"},"Flink SQL \u5b9e\u73b0\u6570\u636e\u5b9e\u65f6\u8ba1\u7b97\u3002"),(0,s.kt)("li",{parentName:"ul"},"StarRocks \u5b9e\u73b0\u6570\u636e\u5b9e\u65f6\u5206\u6790\u3002"),(0,s.kt)("li",{parentName:"ul"},"Paimon \u5b9e\u73b0\u6570\u636e\u5b9e\u65f6\u5165\u6e56\u3002"),(0,s.kt)("li",{parentName:"ul"},"Data V\u6570\u636e\u53ef\u89c6\u5316\u3002")),(0,s.kt)("h2",{id:"\u67b6\u6784"},"\u67b6\u6784"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u57fa\u672c\u521d\u521b\u516c\u53f8\u67b6\u6784",src:t(53525).Z,width:"1276",height:"431"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Flink CDC \u5b9e\u73b0\u6570\u636e\u5b9e\u65f6\u91c7\u96c6\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u57fa\u4e8eFlinkSQL\u6d41\u6279\u4e00\u4f53\u67b6\u6784\u3002"),(0,s.kt)("li",{parentName:"ul"},"Kafka\u548cPaimon\u7684\u6570\u636e\u4e0b\u6c89\u3002"),(0,s.kt)("li",{parentName:"ul"},"StarRocks\u4e0eDataV\u6570\u636e\u53ef\u89c6\u5316\u3002")),(0,s.kt)("h2",{id:"\u5b9e\u6218"},"\u5b9e\u6218"),(0,s.kt)("h3",{id:"\u73af\u5883\u51c6\u5907"},"\u73af\u5883\u51c6\u5907"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u8d44\u6e90\u8981\u5728\u540c\u4e00\u4e2a\u533a\u57df\uff08\u5728\u540c\u4e00\u4e2aVPC\uff09\uff0c\u5c31\u662f\u80fd\u591f\u4e92\u76f8\u8bbf\u95ee\u5c31\u884c\u3002")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"MySQL")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"show variables like '%log_bin%';\nshow master logs;\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\ncat /etc/my.cnf\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u5b89\u88c5JDK")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"yum list java\n\nyum install java-1.8.0-openjdk-devel.x86_64\n\n# \u5bf9\u5e94\u7684\u5b89\u88c5\u76ee\u5f55\u67e5\u770b\ncd /usr/lib/jvm/\n\n")),(0,s.kt)("p",null,"\u914d\u7f6e\u73af\u5883\u53d8\u91cf"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"vi /etc/profile.d/myevn.conf\n\n#java\nexport JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.312.b07-2.el8_5.x86_64\nexport JRE_HOME=$JAVA_HOME/jre\nexport CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH\nexport PATH=$PATH:$JRE_HOME/bin:$JAVA_HOME/bin:$CLASSPATH\n\n\nsource /etc/profile.d/myevn.conf\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u5b89\u88c5Zookeeper")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"mkdir -p /export/software /export/server /export/data\n\ncd /export/software\n\nwget https://archive.apache.org/dist/zookeeper/zookeeper-3.5.10/apache-zookeeper-3.5.10-bin.tar.gz\n\n# \u89e3\u538b\ncd /export/software\ntar -zxf apache-zookeeper-3.5.10-bin.tar.gz -C /export/server/\n\n#\u521b\u5efa\u8f6f\u94fe\u63a5\ncd /export/server\nln -s apache-zookeeper-3.5.10-bin/ zookeeper\n\n# \u521b\u5efa/export/data/zkdata\u76ee\u5f55\ncd /export/data\nmkdir zkdata\n\n# \u4fee\u6539zoo.cfg\u6587\u4ef6\ncd /export/server/zookeeper/conf\ncp zoo_sample.cfg zoo.cfg\nvim zoo.cfg\n\n#\u4fee\u6539\ndataDir=/export/data/zkdata\n#\u6587\u4ef6\u6700\u540e\u6dfb\u52a0 2888\u5fc3\u8df3\u7aef\u53e3 3888\u9009\u4e3e\u7aef\u53e3\nserver.1=192.168.255.46:2888:3888\n#192.168.255.46\u4e3a\u5185\u7f51ip\n\n#\u521b\u5efamyid\u6587\u4ef6\nmkdir -p /export/data/zkdata\necho 1 >/export/data/zkdata/myid\n\n#\u542f\u52a8\ncd /export/server/zookeeper/bin/\nnohup ./zkServer.sh start & > out.log\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u5b89\u88c5Kafka")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"#\u4e0b\u8f7d\u5b89\u88c5\u5305\ncd /export/software\nwget https://downloads.apache.org/kafka/3.5.0/kafka_2.12-3.5.0.tgz\n\n#\u89e3\u538b\u5b89\u88c5\u5305\ncd /export/software/\ntar -xvzf  kafka_2.12-3.5.0.tgz -C /export/server/\n\n#\u521b\u5efa\u8f6f\u94fe\u63a5\ncd /export/server\nln -s kafka_2.12-3.5.0 /export/server/kafka\n\n#\u521b\u5efa/export/data/kafka-logs\u76ee\u5f55\ncd /export/data\nmkdir kafka-logs\n\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"#\u4fee\u6539\u914d\u7f6e\ncd /export/server/kafka/config\nvim server.properties\n\n# \u6307\u5b9abroker\u7684id\nbroker.id=0\n# \u6307\u5b9a kafka\u7684\u7ed1\u5b9a\u76d1\u542c\u7684\u5730\u5740\nlisteners=PLAINTEXT://192.168.255.46:9092\n# \u6307\u5b9aKafka\u6570\u636e\u7684\u4f4d\u7f6e\nlog.dirs=/export/data/kafka-logs\n# \u914d\u7f6ezk\u8282\u70b9\nzookeeper.connect=192.168.255.46:2181\n")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f:\u914d\u7f6e\u6587\u4ef6\u4e2d\u8981\u586b\u5165\u670d\u52a1\u5668\u5185\u7f51ip,\u800c\u4e0d\u80fd\u586b\u5165\u57df\u540d,\u5426\u5219\u4f1a\u5bfc\u81f4\u540e\u7eedflink\u8fde\u63a5\u4e0d\u4e0akafka\u3002")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# \u914d\u7f6e\u73af\u5883\u53d8\u91cf\nvi /etc/profile.d/myevn.conf\n\n#kafka\nexport KAFKA_HOME=/export/server/kafka\nexport PATH=:$PATH:${KAFKA_HOME}/bin\n\nsource /etc/profile.d/myevn.conf\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# \u542f\u52a8\u670d\u52a1\ncd /export/server/kafka/bin/\nnohup ./kafka-server-start.sh -daemon ../config/server.properties & >out.log\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5e38\u7528\u547d\u4ee4\ncd /export/server/kafka/bin/\nkafka-topics.sh --list --bootstrap-server 192.168.255.46:9092\n#\u521b\u5efatopic\nkafka-topics.sh --create --topic test --bootstrap-server 192.168.255.46:9092 \n#\u542f\u52a8\u6d88\u8d39\u8005\nkafka-console-consumer.sh --bootstrap-server 192.168.255.46:9092 --topic test --from-beginning \n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u5b89\u88c5MySQL")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# \u4e0b\u8f7d\u89e3\u538b\nmkdir -p /export/server/mysql5.7   /export/software/\ncd  /export/software/\nwget  https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.29-1.el7.x86_64.rpm-bundle.tar\ntar xvf /export/software/mysql-5.7.29-1.el7.x86_64.rpm-bundle.tar -C /export/server/mysql5.7 \ncd /export/server/mysql5.7 \n\n#\u5378\u8f7dmariadb\nyum remove mariadb mariadb-server mariadb-libs\n\n# \u5b89\u88c5Rpm\nrpm -ivh mysql-community-common-5.7.29-1.el7.x86_64.rpm mysql-community-libs-5.7.29-1.el7.x86_64.rpm mysql-community-client-5.7.29-1.el7.x86_64.rpm mysql-community-server-5.7.29-1.el7.x86_64.rpm\n")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f:\u5982\u679c\u62a5\u9519error: Failed dependencies:\nlibaio.so.1()(64bit) is needed by mysql-community-server-5.7.29-1.el7.x86_64 \u200b libaio.so.1(LIBAIO_0.1)(64bit) is needed by mysql-community-server-5.7.29-1.el7.x86_64 \u200b libaio.so.1(LIBAIO_0.4)(64bit) is needed by mysql-community-server-5.7.29-1.el7.x86_64")),(0,s.kt)("p",null,"\u7cfb\u7edf\u7f3a\u5c11\u4f9d\u8d56:\u5b89\u88c5\u5982\u679c\u7f3a\u5c11\u4f9d\u8d56 \u4f7f\u7528 yum install -y \u5b89\u88c5\u7f3a\u5c11\u7684\u7ec4\u4ef6\u5373\u53ef\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"yum install -y perl.x86_64\nyum install -y libaio.x86_64\nyum install -y net-tools.x86_64\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"#\u521d\u59cb\u5316\u670d\u52a1\u548c\u4fee\u6539\u6587\u4ef6\u6743\u9650\nmysqld --initialize\nchown mysql:mysql /var/lib/mysql -R\n\n# \u542f\u52a8\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsystemctl start mysqld.service\nsystemctl enable mysqld.service\n\n#\u767b\u5f55Mysql\u4fee\u6539\u5bc6\u7801\u53ca\u914d\u7f6e\u8fdc\u7a0b\u767b\u5f55\nPass=$(grep 'A temporary password' /var/log/mysqld.log |awk '{print $NF}')\nmysql -uroot -p\"$Pass\"\nmysql>\nalter user user() identified by \"123456\";\nuse mysql;\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\nFLUSH PRIVILEGES; \nexit;\n")),(0,s.kt)("h3",{id:"flink-cdc-\u6570\u636e\u91c7\u96c6"},"Flink CDC \u6570\u636e\u91c7\u96c6"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u51c6\u5907\u6570\u636e")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u521b\u5efa\u6570\u636e\u5e93bxg\u548cbxg_1(bxg\u662f\u4e1a\u52a1\u6570\u636e\u5e93,bxg_1\u662f\u6a21\u62df\u6d41\u6570\u636e\u9700\u8981\u7684\u5907\u4efd\u6570\u636e\u5e93)\n\ncreate database if not exists bxg character set utf8;\n")),(0,s.kt)("p",null,"SQL \u5b9e\u9a8c\u811a\u672c\u4e0b\u8f7d"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u94fe\u63a5\uff1a",(0,s.kt)("a",{parentName:"p",href:"https://pan.baidu.com/s/11OoHAUwD0Wwde8V2mS-P0Q"},"https://pan.baidu.com/s/11OoHAUwD0Wwde8V2mS-P0Q"),"\n\u63d0\u53d6\u7801\uff1ayyds\n--\u6765\u81ea\u767e\u5ea6\u7f51\u76d8\u8d85\u7ea7\u4f1a\u5458V5\u7684\u5206\u4eab")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u6a21\u62df\u6570\u636e")),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u76f4\u63a5\u7528insert\u6d4b\u8bd5\u65b9\u4fbf\u3002")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"\u5efa\u8868")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"create database if not exists mysql;\nDROP TABLE IF EXISTS mysql.mysql_oe_stu_course_order;\nCREATE TABLE if not exists mysql.mysql_oe_stu_course_order (\n    `id` INT,\n    `student_course_id` INT,\n    `order_id` STRING,\n    `order_detail_id` STRING,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    PRIMARY KEY (`id`) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql',\n    'hostname' = 'rm-cn-zsk3diubc000qk.rwlb.rds.aliyuncs.com',\n    'port' = '3306',\n    'username' = 'testflink',\n    'password' = 'fhakjsdhfk123@@',\n    'database-name' = 'bxg',\n    'table-name' = 'oe_stu_course_order'\n);\n\nCREATE TABLE if not exists mysql.mysql_oe_stu_course (\n    `id` INT,\n    `student_id` STRING,\n    `course_id` INT,\n    `status` TINYINT,\n    `contract_status` TINYINT,\n    `learn_status` TINYINT,\n    `service_days` SMALLINT,\n    `service_expires` TIMESTAMP(3),\n    `validity_days` INT,\n    `validity_expires` TIMESTAMP(3),\n    `terminate_cause` TINYINT,\n    `effective_date` TIMESTAMP(3),\n    `finished_time` TIMESTAMP(3),\n    `total_progress` DECIMAL(10,2),\n    `purchase_time` INT,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    PRIMARY KEY (`id`) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql',\n    'hostname' = 'rm-cn-zsk3diubc000qk.rwlb.rds.aliyuncs.com',\n    'port' = '3306',\n    'username' = 'testflink',\n    'password' = 'fhakjsdhfk123@@',\n    'database-name' = 'bxg',\n    'table-name' = 'oe_stu_course'\n);\n\n\nCREATE TABLE if not exists mysql.mysql_oe_order (\n    `id` STRING,\n    `channel` STRING,\n    `student_id` STRING,\n    `order_no` STRING,\n    `total_amount` DECIMAL(10,2),\n    `discount_amount` DECIMAL(10,2),\n    `charge_against_amount` DECIMAL(10,2),\n    `payable_amount` DECIMAL(10,2),\n    `status` TINYINT,\n    `pay_status` TINYINT,\n    `pay_time` TIMESTAMP(3),\n    `paid_amount` DECIMAL(10,2),\n    `effective_date` TIMESTAMP(3),\n    `terminal` TINYINT,\n    `refund_status` TINYINT,\n    `refund_amount` DECIMAL(10,2),\n    `refund_time` TIMESTAMP(3),\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql',\n    'hostname' = 'rm-cn-zsk3diubc000qk.rwlb.rds.aliyuncs.com',\n    'port' = '3306',\n    'username' = 'testflink',\n    'password' = 'fhakjsdhfk123@@',\n    'database-name' = 'bxg',\n    'table-name' = 'oe_order'\n);\n\nCREATE TABLE if not exists mysql.mysql_oe_course (\n    `id` INT,\n    `grade_name` STRING,\n    `bigimg_path` STRING,\n    `video_url` STRING,\n    `img_alt` STRING,\n    `description` STRING,\n    `detailimg_path` STRING,\n    `smallimg_path` STRING,\n    `sort` INT,\n    `status` STRING,\n    `learnd_count` INT,\n    `learnd_count_flag` INT,\n    `original_cost` DECIMAL(10,2),\n    `current_price` DECIMAL(10,2),\n    `course_length` DECIMAL(10,2),\n    `menu_id` INT,\n    `is_free` BOOLEAN,\n    `course_detail` STRING,\n    `course_detail_mobile` STRING,\n    `course_detail1` STRING,\n    `course_detail1_mobile` STRING,\n    `course_plan_detail` STRING,\n    `course_plan_detail_mobile` STRING,\n    `course_detail2` STRING,\n    `course_detail2_mobile` STRING,\n    `course_outline` STRING,\n    `common_problem` STRING,\n    `common_problem_mobile` STRING,\n    `lecturer_id` INT,\n    `is_recommend` INT,\n    `recommend_sort` INT,\n    `qqno` STRING,\n    `description_show` INT,\n    `rec_img_path` STRING,\n    `pv` INT,\n    `course_type` INT,\n    `default_student_count` INT,\n    `study_status` INT,\n    `online_course` INT,\n    `course_level` INT,\n    `content_type` INT,\n    `recommend_type` INT,\n    `employment_rate` STRING,\n    `employment_salary` STRING,\n    `score` STRING,\n    `cover_url` STRING,\n    `offline_course_url` STRING,\n    `outline_url` STRING,\n    `project_page_url` STRING,\n    `preschool_test_flag` BOOLEAN,\n    `service_period` INT,\n    `included_validity_period` TINYINT,\n    `validity_period` INT,\n    `qualified_jobs` STRING,\n    `work_year_min` INT,\n    `work_year_max` INT,\n    `promote_flag` BOOLEAN,\n    `create_person` STRING,\n    `update_person` STRING,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `is_delete` BOOLEAN,\n    PRIMARY KEY (`id`) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql',\n    'hostname' = 'rm-cn-zsk3diubc000qk.rwlb.rds.aliyuncs.com',\n    'port' = '3306',\n    'username' = 'testflink',\n    'password' = 'fhakjsdhfk123@@',\n    'database-name' = 'bxg',\n    'table-name' = 'oe_course'\n);\n\n")),(0,s.kt)("p",null,"\u6267\u884c\u6d4b\u8bd5"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u6d4b\u8bd5flink CDC",src:t(9494).Z,width:"1326",height:"679"})),(0,s.kt)("h3",{id:"\u7ef4\u8868\u6570\u636e\u4e0b\u6c89\u5230paimon"},"\u7ef4\u8868\u6570\u636e\u4e0b\u6c89\u5230Paimon"),(0,s.kt)("p",null,"\u5148\u521b\u5efaPaimon\u7684Catalog\u3002"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u6d4b\u8bd5flink CDC",src:t(80942).Z,width:"1366",height:"515"})),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"create database if not exists paimontest.dim;\nCREATE TABLE if not exists paimontest.dim.dim_oe_course(\n    `id` INT,\n    `grade_name` STRING,\n    `bigimg_path` STRING,\n    `video_url` STRING,\n    `img_alt` STRING,\n    `description` STRING,\n    `detailimg_path` STRING,\n    `smallimg_path` STRING,\n    `sort` INT,\n    `status` STRING,\n    `learnd_count` INT,\n    `learnd_count_flag` INT,\n    `original_cost` DECIMAL(10,2),\n    `current_price` DECIMAL(10,2),\n    `course_length` DECIMAL(10,2),\n    `menu_id` INT,\n    `is_free` BOOLEAN,\n    `course_detail` STRING,\n    `course_detail_mobile` STRING,\n    `course_detail1` STRING,\n    `course_detail1_mobile` STRING,\n    `course_plan_detail` STRING,\n    `course_plan_detail_mobile` STRING,\n    `course_detail2` STRING,\n    `course_detail2_mobile` STRING,\n    `course_outline` STRING,\n    `common_problem` STRING,\n    `common_problem_mobile` STRING,\n    `lecturer_id` INT,\n    `is_recommend` INT,\n    `recommend_sort` INT,\n    `qqno` STRING,\n    `description_show` INT,\n    `rec_img_path` STRING,\n    `pv` INT,\n    `course_type` INT,\n    `default_student_count` INT,\n    `study_status` INT,\n    `online_course` INT,\n    `course_level` INT,\n    `content_type` INT,\n    `recommend_type` INT,\n    `employment_rate` STRING,\n    `employment_salary` STRING,\n    `score` STRING,\n    `cover_url` STRING,\n    `offline_course_url` STRING,\n    `outline_url` STRING,\n    `project_page_url` STRING,\n    `preschool_test_flag` BOOLEAN,\n    `service_period` INT,\n    `included_validity_period` INT,\n    `validity_period` INT,\n    `qualified_jobs` STRING,\n    `work_year_min` INT,\n    `work_year_max` INT,\n    `promote_flag` BOOLEAN,\n    `create_person` STRING,\n    `update_person` STRING,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `is_delete` BOOLEAN,\n   PRIMARY KEY (id) NOT ENFORCED\n);\n")),(0,s.kt)("p",null,"MySQL\u6570\u636e\u5199\u5165\u5230Paimon\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"insert into paimontest.dim.dim_oe_course\nselect * from mysql.mysql_oe_course;\n\n#\u542f\u52a8\u6210\u529f\u4ee5\u540e\u67e5\u8be2\u4e0b\u6570\u636e\nselect * from paimontest.dim.dim_oe_course;\n")),(0,s.kt)("p",null,"\u5982\u4e0b\u67e5\u8be2Paimon\u8868\uff0c\u5982\u679c\u6709\u6570\u636e\u90a3\u4e48\u8bf4\u660e\u521b\u5efa\u6210\u529f\u3002"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u5bfc\u5165\u6570\u636e\u5230Paimon\u8868\u6210\u529f",src:t(4021).Z,width:"1354",height:"718"})),(0,s.kt)("h3",{id:"flink-cdc-\u63a5\u5165mysql\u6570\u636e\u5230kafka"},"Flink CDC \u63a5\u5165MySQL\u6570\u636e\u5230Kafka"),(0,s.kt)("p",null,"\u521b\u5efaKafka Topic\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5e38\u7528\u547d\u4ee4\ncd /export/server/kafka/bin/\n./kafka-topics.sh --list --bootstrap-server 192.168.255.46:9092\n\n./kafka-topics.sh --create --topic ods_oe_order --bootstrap-server 192.168.255.46:9092 \n./kafka-topics.sh --create --topic ods_oe_stu_course --bootstrap-server 192.168.255.46:9092 \n./kafka-topics.sh --create --topic ods_oe_stu_course_order --bootstrap-server 192.168.255.46:9092 \n")),(0,s.kt)("p",null,"\u521b\u5efaFlink CDC\u8bfb\u53d6MySQL\u6570\u636e\u5230Kafka\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"create database if not exists dw;\nCREATE TABLE if not exists dw.kafka_ods_oe_stu_course_order (\n    `id` INT,\n    `student_course_id` INT,\n    `order_id` STRING,\n    `order_detail_id` STRING,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    proctime as proctime(),\n   PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n  'connector' = 'upsert-kafka',\n  'topic' = 'ods_oe_stu_course_order',\n  'properties.bootstrap.servers' = '192.168.255.46:9092',\n  'key.format' = 'json',\n  'value.format' = 'json'\n);\n\nCREATE TABLE if not exists dw.kafka_ods_oe_stu_course (\n    `id` INT,\n    `student_id` STRING,\n    `course_id` INT,\n    `status` INT,\n    `contract_status` INT,\n    `learn_status` INT,\n    `service_days` INT,\n    `service_expires` TIMESTAMP(3),\n    `validity_days` INT,\n    `validity_expires` TIMESTAMP(3),\n    `terminate_cause` INT,\n    `effective_date` TIMESTAMP(3),\n    `finished_time` TIMESTAMP(3),\n    `total_progress` DECIMAL(10,2),\n    `purchase_time` INT,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    proctime as proctime(),\n   PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n  'connector' = 'upsert-kafka',\n  'topic' = 'ods_oe_stu_course',\n  'properties.bootstrap.servers' = '192.168.255.46:9092',\n  'key.format' = 'json',\n  'value.format' = 'json'\n);\n\nCREATE TABLE if not exists dw.kafka_ods_oe_order (\n    `id` STRING,\n    `channel` STRING,\n    `student_id` STRING,\n    `order_no` STRING,\n    `total_amount` DECIMAL(10,2),\n    `discount_amount` DECIMAL(10,2),\n    `charge_against_amount` DECIMAL(10,2),\n    `payable_amount` DECIMAL(10,2),\n    `status` INT,\n    `pay_status` INT,\n    `pay_time` TIMESTAMP(3),\n    `paid_amount` DECIMAL(10,2),\n    `effective_date` TIMESTAMP(3),\n    `terminal` INT,\n    `refund_status` INT,\n    `refund_amount` DECIMAL(10,2),\n    `refund_time` TIMESTAMP(3),\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    proctime as proctime(),\n   PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n  'connector' = 'upsert-kafka',\n  'topic' = 'ods_oe_order',\n  'properties.bootstrap.servers' = '192.168.255.46:9092',\n  'key.format' = 'json',\n  'value.format' = 'json'\n);\n")),(0,s.kt)("p",null,"\u5199\u5165\u6570\u636e\u5230Kafka"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u521b\u5efamysql_to_kafka_ods\u4f5c\u4e1a\u8349\u7a3f,\u4ee3\u7801\u5982\u4e0b\u56e0\u4e3a\u662f\u591a\u4e2ainsert\u8bed\u53e5\u5199\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d,\u8981\u5199\u5728BEGIN STATEMENT SET;END;\u8bed\u53e5\u4e2d.\u8bed\u53e5\u4e2doptions\u8fdb\u884c\u4e86\u6ce8\u91ca,\u9ed8\u8ba4\u662f\u540c\u6b65\u6240\u6709\u6570\u636e.\u6253\u5f00\u6ce8\u91ca,\u53ea\u540c\u6b65\u6700\u65b0\u7684\u6570\u636e\u3002")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"BEGIN STATEMENT SET;\ninsert into dw.kafka_ods_oe_stu_course_order\nselect *\nfrom mysql.mysql_oe_stu_course_order\n-- /*+ OPTIONS('scan.startup.mode' ='latest-offset') */\n;\n\ninsert into dw.kafka_ods_oe_stu_course\nselect *\nfrom mysql.mysql_oe_stu_course\n-- /*+ OPTIONS('scan.startup.mode' ='latest-offset') */\n;\n\ninsert into dw.kafka_ods_oe_order\nselect *\nfrom mysql.mysql_oe_order\n-- /*+ OPTIONS('scan.startup.mode' ='latest-offset') */\n;\nEND;\n")),(0,s.kt)("p",null,"\u67e5\u8be2\u6570\u636e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"select * from dw.kafka_ods_oe_order;\n")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"flinkcdc \u91c7\u96c6\u6570\u636e\u5230Kafka",src:t(69873).Z,width:"1366",height:"651"})),(0,s.kt)("p",null,"\u547d\u4ee4\u6d88\u8d39\u6d4b\u8bd5"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"cd /export/server/kafka/bin/\n\n./kafka-console-consumer.sh --bootstrap-server 192.168.255.46:9092 --topic ods_oe_order --from-beginning\n")),(0,s.kt)("p",null,"\u7ed3\u679c\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{"id":"168e4fba9c5b453f8f5e775b12c561cf","channel":"BXG","student_id":"67d7edd954a211ea982f525400e0a58f","order_no":"200221200l5af9MJ7Rwq","total_amount":8.8E+3,"discount_amount":0,"charge_against_amount":0,"payable_amount":8.8E+3,"status":1,"pay_status":2,"pay_time":"2022-02-21 20:07:13","paid_amount":8.8E+3,"effective_date":"2022-02-21 20:07:13","terminal":0,"refund_status":0,"refund_amount":0,"refund_time":null,"create_time":"2022-02-21 20:05:23","update_time":"2022-02-21 20:05:45","delete_flag":false}\n{"id":"9de7398d1da24c3784b7d5faace64fab","channel":"BXG","student_id":"2c9081a36f89060d016f9df7e5aa0013","order_no":"20011316V5Kjxa3330XX","total_amount":22,"discount_amount":0,"charge_against_amount":0,"payable_amount":22,"status":1,"pay_status":2,"pay_time":"2022-01-13 16:16:36","paid_amount":22,"effective_date":"2022-01-13 16:16:36","terminal":0,"refund_status":0,"refund_amount":0,"refund_time":null,"create_time":"2022-01-13 16:14:48","update_time":"2022-01-13 16:16:32","delete_flag":false}\n')),(0,s.kt)("h3",{id:"kafka\u6570\u636e\u540c\u6b65\u5230paimon\u7684ods\u5c42"},"Kafka\u6570\u636e\u540c\u6b65\u5230Paimon\u7684ods\u5c42"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"\ncreate database if not exists paimontest.ods;\n\nCREATE TABLE if not exists paimontest.ods.paimon_ods_oe_stu_course_order (\n    `id` INT,\n    `student_course_id` INT,\n    `order_id` STRING,\n    `order_detail_id` STRING,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    `proctime` timestamp,\n     dt string comment '\u65e5\u671f',\n   PRIMARY KEY (id,dt) NOT ENFORCED\n)  partitioned by (dt)\n;\n\nCREATE TABLE if not exists paimontest.ods.paimon_ods_oe_stu_course (\n    `id` INT,\n    `student_id` STRING,\n    `course_id` INT,\n    `status` INT,\n    `contract_status` INT,\n    `learn_status` INT,\n    `service_days` INT,\n    `service_expires` TIMESTAMP(3),\n    `validity_days` INT,\n    `validity_expires` TIMESTAMP(3),\n    `terminate_cause` INT,\n    `effective_date` TIMESTAMP(3),\n    `finished_time` TIMESTAMP(3),\n    `total_progress` DECIMAL(10,2),\n    `purchase_time` INT,\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    `proctime` timestamp,\n    dt string comment '\u65e5\u671f',\n   PRIMARY KEY (id,dt) NOT ENFORCED\n) partitioned by (dt)\n;\n\nCREATE TABLE if not exists paimontest.ods.paimon_ods_oe_order (\n    `id` STRING,\n    `channel` STRING,\n    `student_id` STRING,\n    `order_no` STRING,\n    `total_amount` DECIMAL(10,2),\n    `discount_amount` DECIMAL(10,2),\n    `charge_against_amount` DECIMAL(10,2),\n    `payable_amount` DECIMAL(10,2),\n    `status` INT,\n    `pay_status` INT,\n    `pay_time` TIMESTAMP(3),\n    `paid_amount` DECIMAL(10,2),\n    `effective_date` TIMESTAMP(3),\n    `terminal` INT,\n    `refund_status` INT,\n    `refund_amount` DECIMAL(10,2),\n    `refund_time` TIMESTAMP(3),\n    `create_time` TIMESTAMP(3),\n    `update_time` TIMESTAMP(3),\n    `delete_flag` BOOLEAN,\n    `proctime` timestamp,\n    dt string comment '\u65e5\u671f',\n   PRIMARY KEY (id,dt) NOT ENFORCED\n) partitioned by (dt)\n;\n\n")),(0,s.kt)("p",null,"\u6570\u636e\u5bfc\u5165\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"BEGIN STATEMENT SET;\ninsert into paimontest.ods.paimon_ods_oe_stu_course_order\nselect\n    *,\n    date_format(create_time,'yyyy-MM-dd') as dt\nfrom dw.kafka_ods_oe_stu_course_order;\ninsert into paimontest.ods.paimon_ods_oe_stu_course\nselect\n    *,\n    date_format(create_time,'yyyy-MM-dd') as dt\nfrom dw.kafka_ods_oe_stu_course;\ninsert into paimontest.ods.paimon_ods_oe_order\nselect\n    *,\n    date_format(create_time,'yyyy-MM-dd') as dt\nfrom dw.kafka_ods_oe_order;\nEND;\n")),(0,s.kt)("p",null,"\u6d4b\u8bd5\u5199\u5165\u6570\u636e\u662f\u5426\u6210\u529f\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"select * from paimontest.ods.paimon_ods_oe_order;\nselect * from paimontest.ods.paimon_ods_oe_stu_course_order;\nselect * from paimontest.ods.paimon_ods_oe_stu_course;\n")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u6d4b\u8bd5\u6570\u636e\u7ed3\u679c",src:t(6879).Z,width:"1265",height:"669"})),(0,s.kt)("h3",{id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406"},"\u6d41\u6279\u4e00\u4f53\u5904\u7406"),(0,s.kt)("h4",{id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dwd\u5c42kafka"},"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWD\u5c42(kafka)"),(0,s.kt)("p",null,"\u5148\u521b\u5efa\u5bf9\u5e94\u7684\u4e3b\u9898\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"cd /export/server/kafka/bin/\n./kafka-topics.sh --bootstrap-server 192.168.255.46:9092 --create --topic dwd_oe_stu_course_order \n")),(0,s.kt)("p",null,"\u5728Flink\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u8868\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE if not exists dw.kafka_dwd_oe_stu_course_order (\n     `id` int,\n     `stu_course_id` int,\n     `order_id` string,\n     `course_id` int,\n     `stu_course_status` int,\n     `stu_course_status_des` string,\n     `stu_course_delete_flag` BOOLEAN,\n     `payable_amount` decimal(10,2),\n     `pay_status` int,\n     `pay_time` TIMESTAMP(3),\n     `paid_amount` decimal(10,2),\n     `refund_status` int,\n     `order_delete_flag` boolean,\n     `grade_name` string,\n     `is_complete_order` boolean,\n     PRIMARY KEY (`id`) NOT ENFORCED\n) WITH (\n  'connector' = 'upsert-kafka',\n  'topic' = 'dwd_oe_stu_course_order',\n  'properties.bootstrap.servers' = '192.168.255.46:9092',\n  'key.format' = 'json',\n  'value.format' = 'json'\n);\n")),(0,s.kt)("p",null,"Kafk\u7684ods\u5c42\u6570\u636e\u8fdb\u884c\u6253\u5bbd\u64cd\u4f5c\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"insert into dw.kafka_dwd_oe_stu_course_order\nSELECT\n    `osco`.`id`,\n    `osco`.`student_course_id`,\n    `osco`.`order_id`,\n    `osc`.`course_id`,\n    `osc`.`status` as `stu_course_status`,\n     case `osc`.`status` when 0 then '\u8bd5\u5b66' when 1 then '\u751f\u6548' when 2 then '\u5f85\u751f\u6548' when -1 then '\u505c\u8bfe' else '\u9000\u8d39' end as `stu_course_status_des`,\n    `osc`.`delete_flag` as `stu_course_delete_flag`,\n    `oo`.`payable_amount`,\n    `oo`.`pay_status`,\n    `oo`.`pay_time`,\n    `oo`.`paid_amount`,\n    `oo`.`refund_status`,\n    `oo`.`delete_flag` as `order_delete_flag`,\n    `oc`.`grade_name`,\n    if (oo.`payable_amount`>0 and `oo`.`pay_status`=2 and `oo`.`delete_flag` = false and `osc`.`delete_flag` = false, true, false) as is_complete_order\nFROM dw.kafka_ods_oe_stu_course_order AS osco\nLEFT JOIN dw.kafka_ods_oe_stu_course AS osc\nON osc.id = osco.student_course_id\nLEFT JOIN dw.kafka_ods_oe_order AS oo\nON oo.id = osco.order_id\nLEFT JOIN paimontest.dim.dim_oe_course\n/*+ OPTIONS('lookup.join.cache.ttl' = '1h') */ for SYSTEM_TIME AS OF osc.`proctime` AS oc\nON oc.id = osc.course_id\n;\n")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("a",{parentName:"p",href:"http://wuchong.me/blog/2020/02/25/demo-building-real-time-application-with-flink-sql/"},"http://wuchong.me/blog/2020/02/25/demo-building-real-time-application-with-flink-sql/"))),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"join\u7ef4\u8868\u7684\u65f6\u5019\u4f7f\u7528 for SYSTEM_TIME AS OF osc.",(0,s.kt)("inlineCode",{parentName:"p"},"proctime"),"\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528\u5386\u53f2\u7248\u672c\u7684\u7ef4\u8868\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u8bed\u6cd5\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\u5f53\u65f6\u7684\u5feb\u7167\u7ef4\u8868\u6570\u636e\u3002")),(0,s.kt)("p",null,"\u9a8c\u8bc1\u6570\u636e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"select * from dw.kafka_dwd_oe_stu_course_order;\n")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"dwd\u6570\u636e\u7ed3\u679c",src:t(7758).Z,width:"1394",height:"643"})),(0,s.kt)("p",null,"\u6d88\u8d39kafka\u6570\u636e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"cd /export/server/kafka/bin/\n\n./kafka-console-consumer.sh --bootstrap-server 192.168.255.46:9092 --topic dwd_oe_stu_course_order --from-beginning\n")),(0,s.kt)("p",null,"\u5f97\u5230\u7684\u7ed3\u679c\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{"id":1434413,"stu_course_id":2389883,"order_id":"d352f58419c243fc931c1e6fb4ffa3ae","course_id":1000938,"stu_course_status":1,"stu_course_status_des":"\u751f\u6548","stu_course_delete_flag":false,"payable_amount":0,"pay_status":0,"pay_time":null,"paid_amount":0,"refund_status":0,"order_delete_flag":false,"grade_name":"\u8d1d\u8d1d\u5fae\u8bfe","is_complete_order":false}\n{"id":1435265,"stu_course_id":2390775,"order_id":"2e5c292c04ee498392df62a3133dc830","course_id":957,"stu_course_status":2,"stu_course_status_des":"\u5f85\u751f\u6548","stu_course_delete_flag":false,"payable_amount":1.298E+6,"pay_status":2,"pay_time":"2022-09-10 15:48:11","paid_amount":1.298E+6,"refund_status":0,"order_delete_flag":false,"grade_name":"UI/UE\u8bbe\u8ba1\u5728\u7ebf\u5c31\u4e1a\u73ed","is_complete_order":true}\nnull\n{"id":1434414,"stu_course_id":2389884,"order_id":"aa4d3fdae9704f6b8548561d0f5fcb65","course_id":1000936,"stu_course_status":1,"stu_course_status_des":"\u751f\u6548","stu_course_delete_flag":false,"payable_amount":0,"pay_status":0,"pay_time":null,"paid_amount":0,"refund_status":0,"order_delete_flag":false,"grade_name":"\u7b14\u8bb0\u517c\u5bb9\u6d4b\u8bd5","is_complete_order":false}\n{"id":1435262,"stu_course_id":2390772,"order_id":"5d36d9fd02ae45a5a69db46f688dd03f","course_id":956,"stu_course_status":1,"stu_course_status_des":"\u751f\u6548","stu_course_delete_flag":false,"payable_amount":1.498E+4,"pay_status":2,"pay_time":"2022-09-10 11:36:44","paid_amount":1.498E+4,"refund_status":0,"order_delete_flag":false,"grade_name":"JavaEE\u5728\u7ebf\u5c31\u4e1a\u73ed","is_complete_order":true}\n')),(0,s.kt)("h4",{id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dws\u5c42kafka"},"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWS\u5c42(kafka)"),(0,s.kt)("p",null,"\u521b\u5efakafka\u7684\u4e3b\u9898\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"cd /export/server/kafka/bin/\n\n./kafka-topics.sh --bootstrap-server 192.168.255.46:9092 --create --topic dws_course_revenue\n./kafka-topics.sh --bootstrap-server 192.168.255.46:9092 --create --topic dws_overall_revenue\n./kafka-topics.sh --list --bootstrap-server 192.168.255.46:9092\n\n\n./kafka-console-consumer.sh --bootstrap-server 192.168.255.46:9092 --topic dwd_oe_stu_course_order --from-beginning\n\n")),(0,s.kt)("p",null,"\u7528Flink\u5b9e\u65f6\u5199\u5165\u5230kafka\u7684DWS\u5c42\u6570\u636e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE if not exists dw.kafka_dws_course_revenue(\n    `course_id` int,\n    `date` string,\n    `total_cnt` bigint,\n    `toatal_money` decimal(38,4),\n    `avg` decimal(38,4),\n    `stu_course_order_status` string,\n    PRIMARY KEY (`course_id`,`date`) NOT ENFORCED\n) WITH (\n  'connector' = 'upsert-kafka',\n  'topic' = 'dws_course_revenue',\n  'properties.bootstrap.servers' = '192.168.255.46:9092',\n  'key.format' = 'json',\n  'value.format' = 'json'\n);\n\nCREATE TABLE if not exists dw.kafka_dws_overall_revenue (\n    `course_id` int,\n    `course_name` string,\n    `paid_count` bigint,\n    `paid_amount` decimal(38,4),\n    PRIMARY KEY (`course_id`) NOT ENFORCED\n) WITH (\n  'connector' = 'upsert-kafka',\n  'topic' = 'dws_overall_revenue',\n  'properties.bootstrap.servers' = '192.168.255.46:9092',\n  'key.format' = 'json',\n  'value.format' = 'json'\n);\n")),(0,s.kt)("p",null,"\u8f93\u5165\u5199\u5165\u5230kafka\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"BEGIN STATEMENT SET;\n\nINSERT INTO dw.kafka_dws_course_revenue\nSELECT\n    ifnull(course_id,-1) as course_id,\n    '\u5408\u8ba1' AS `date`,\n    count(1) AS `total_cnt`,\n    CASE WHEN count(1) >0 THEN sum(paid_amount) ELSE 0 END  AS  `toatal_money`,\n    CASE WHEN count(1) >0 THEN sum(paid_amount) / if(count(1)<=0,1,count(1)) ELSE 0 END AS `avg`,\n    CONCAT('\u3010',cast(course_id as string),'\u3011',grade_name)  as  `stu_course_order_status`\nFROM dw.kafka_dwd_oe_stu_course_order\nWHERE is_complete_order = true\n  AND stu_course_status not in (8)\nGROUP BY course_id,grade_name\n\nunion\n\nselect\n    ifnull(course_id,-1) as course_id,\n    ifnull(date_format(pay_time, 'yyyy/MM/dd'),'-1') as `date`,\n    count(1) AS `total_cnt`,\n    CASE WHEN count(1) > 0 THEN sum(paid_amount) ELSE 0 END AS `toatal_money`,\n    CASE WHEN count(1) > 0 THEN sum(paid_amount) / if(count(1)=0,1,count(1)) ELSE 0 END AS `avg`,\n    LISTAGG(stu_course_status_des) as `stu_course_order_status`\nfrom dw.kafka_dwd_oe_stu_course_order\nWHERE is_complete_order is true\ngroup by course_id,date_format(pay_time, 'yyyy/MM/dd');\n\n\nINSERT INTO dw.kafka_dws_overall_revenue\nSELECT\n    ifnull(course_id,-1) as course_id,\n    grade_name AS `course_name`,\n    COUNT(CASE WHEN (is_complete_order is true AND refund_status not in (-1))\n                   THEN order_id\n               ELSE null\n        END)  AS `paid_count`,\n    SUM(CASE WHEN (is_complete_order is true AND refund_status not in (-1))\n                 THEN paid_amount\n             ELSE null\n        END) AS  `paid_amount`\nFROM dw.kafka_dwd_oe_stu_course_order\nGROUP BY course_id,grade_name;\n\nEND;\n")),(0,s.kt)("p",null,"\u9a8c\u8bc1\u6570\u636e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"select * from dw.kafka_dws_course_revenue;\n")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u6700\u540e\u7684\u7ed3\u679c\u4e3a",src:t(3293).Z,width:"1258",height:"695"})),(0,s.kt)("h4",{id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dwd\u5c42paimon"},"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWD\u5c42(paimon)"),(0,s.kt)("p",null,"\u521b\u5efaPaimon\u8868\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"create database if not exists paimontest.dwd;\nCREATE TABLE if not exists paimontest.dwd.paimon_dwd_oe_stu_course_order (\n     `id` int,\n     `stu_course_id` int,\n     `order_id` string,\n     `course_id` int,\n     `stu_course_status` int,\n     `stu_course_status_des` string,\n     `stu_course_delete_flag` BOOLEAN,\n     `payable_amount` decimal(10,2),\n     `pay_status` int,\n     `pay_time` TIMESTAMP(3),\n     `paid_amount` decimal(10,2),\n     `refund_status` int,\n     `order_delete_flag` boolean,\n     `grade_name` string,\n     `is_complete_order` boolean,\n     PRIMARY KEY (`id`) NOT ENFORCED\n)\n;\n")),(0,s.kt)("p",null,"Kafka\u7684dwd\u5c42\u6570\u636e\u5199\u5165\u5230Paimon\u8868"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"insert into paimontest.dwd.paimon_dwd_oe_stu_course_order\nselect * from dw.kafka_dwd_oe_stu_course_order;\n")),(0,s.kt)("p",null,"\u9a8c\u8bc1\u6570\u636e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"select * from paimontest.dwd.paimon_dwd_oe_stu_course_order;\n")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u9a8c\u8bc1dwd\u6570\u636e\u5199\u5165",src:t(26160).Z,width:"1251",height:"701"})),(0,s.kt)("h4",{id:"\u6d41\u6279\u4e00\u4f53\u5904\u7406dws\u5c42paimon"},"\u6d41\u6279\u4e00\u4f53\u5904\u7406DWS\u5c42(paimon)"),(0,s.kt)("p",null,"\u521b\u5efaPaimon\u7684dws\u8868\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"create database if not exists paimontest.dws;\nCREATE TABLE if not exists paimontest.dws.paimon_dws_course_revenue(\n    `course_id` int,\n    `date` string,\n    `total_cnt` bigint,\n    `toatal_money` decimal(38,4),\n    `avg` decimal(38,4),\n    `stu_course_order_status` string,\n    PRIMARY KEY (`course_id`,`date`) NOT ENFORCED\n)\n;\n\nCREATE TABLE if not exists paimontest.dws.paimon_dws_overall_revenue (\n    `course_id` int,\n    `course_name` string,\n    `paid_count` bigint,\n    `paid_amount` decimal(38,4),\n    PRIMARY KEY (`course_id`) NOT ENFORCED\n)\n;\n")),(0,s.kt)("p",null,"\u628aKafka\u7684dws\u5c42\u6570\u636e\u5199\u5165\u5230Paimon\u8868"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"BEGIN STATEMENT SET;\n\ninsert into paimontest.dws.paimon_dws_course_revenue\nselect\n*\nfrom dw.kafka_dws_course_revenue\n;\n\ninsert into paimontest.dws.paimon_dws_overall_revenue\nselect\n*\nfrom dw.kafka_dws_overall_revenue\n;\n\nEND;\n")),(0,s.kt)("p",null,"\u6570\u636e\u9a8c\u8bc1\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"select * from paimontest.dws.paimon_dws_overall_revenue;\n")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u5f97\u5230\u7684paimon\u7684\u7ed3\u679c",src:t(51654).Z,width:"1269",height:"646"})),(0,s.kt)("h3",{id:"\u7ed3\u679c\u5bfc\u5165starrocks"},"\u7ed3\u679c\u5bfc\u5165StarRocks"),(0,s.kt)("p",null,"\u521b\u5efaStarRocks\u7684dws\u8868\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},'create database if not exists dws;\n\nCREATE TABLE IF NOT EXISTS dws.dws_course_revenue\n(\n    `course_id` int,\n    `date` varchar(255),\n    `total_cnt` bigint,\n    `toatal_money` decimal(27,4),\n    `avg` decimal(27,4),\n    `stu_course_order_status` string\n) Unique Key (`course_id`,`date`)\nDISTRIBUTED BY HASH(`course_id`) BUCKETS 10\nPROPERTIES (\n"replication_num" = "1"\n);\n\nCREATE TABLE IF NOT EXISTS dws.dws_overall_revenue\n(\n    `course_id` int,\n    `course_name` string,\n    `paid_count` bigint,\n    `paid_amount` decimal(27,4)\n) Unique Key (`course_id`)\nDISTRIBUTED BY HASH(`course_id`) BUCKETS 10\nPROPERTIES (\n"replication_num" = "1"\n);\n')),(0,s.kt)("p",null,"\u521b\u5efaFlink\u5bf9\u5e94StarRocks\u7684\u8868\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"create database if not exists starrocks;\nCREATE TABLE if not exists starrocks.starrocks_dws_course_revenue_load(\n    `course_id` int,\n    `date` string,\n    `total_cnt` bigint,\n    `toatal_money` decimal(38,4),\n    `avg` decimal(38,4),\n    `stu_course_order_status` string,\n    PRIMARY KEY (`course_id`,`date`) NOT ENFORCED\n) WITH (\n 'connector' = 'starrocks',\n 'jdbc-url'='jdbc:mysql://fe-c-166e6b1814e54a8c-internal.starrocks.aliyuncs.com:9030',\n 'load-url'='fe-c-166e6b1814e54a8c-internal.starrocks.aliyuncs.com:8030',\n 'database-name' = 'dws',\n 'table-name' = 'dws_course_revenue',\n 'username' = 'admin',\n 'password' = 'Itcast123',\n 'sink.buffer-flush.interval-ms' = '5000'\n);\n\nCREATE TABLE if not exists starrocks.starrocks_dws_overall_revenue_load(\n    `course_id` int,\n    `course_name` string,\n    `paid_count` bigint,\n    `paid_amount` decimal(38,4),\n    PRIMARY KEY (`course_id`) NOT ENFORCED\n) WITH (\n 'connector' = 'starrocks',\n 'jdbc-url'='jdbc:mysql://fe-c-166e6b1814e54a8c-internal.starrocks.aliyuncs.com:9030',\n 'load-url'='fe-c-166e6b1814e54a8c-internal.starrocks.aliyuncs.com:8030',\n 'database-name' = 'dws',\n 'table-name' = 'dws_overall_revenue',\n 'username' = 'admin',\n 'password' = 'Itcast123',\n 'sink.buffer-flush.interval-ms' = '5000'\n);\n")),(0,s.kt)("p",null,"\u53c2\u6570\u8bb2\u89e3\uff1a"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"'connector' = 'starrocks',  -- \u8fde\u63a5\u5668"),(0,s.kt)("li",{parentName:"ul"},"'jdbc-url'='jdbc:mysql://fe-c-166e6b1814e54a8c-internal.starrocks.- aliyuncs.com:9030', -- JDBC\u8fde\u63a5\u7684URL,\u683c\u5f0f jdbc:mysql://fe_ip:port"),(0,s.kt)("li",{parentName:"ul"},"'load-url'='fe-c-166e6b1814e54a8c-internal.starrocks.aliyuncs.- com:8030', -- \u6570\u636e\u5bfc\u5165\u7684URL,\u683c\u5f0f fe_ip:http_port"),(0,s.kt)("li",{parentName:"ul"},"'database-name' = 'dws', -- \u6570\u636e\u5e93\u540d\u79f0"),(0,s.kt)("li",{parentName:"ul"},"'table-name' = 'dws_overall_revenue', -- \u8868\u540d"),(0,s.kt)("li",{parentName:"ul"},"'username' = 'admin', -- \u7528\u6237\u540d"),(0,s.kt)("li",{parentName:"ul"},"'password' = 'Itcast123',  -- \u5bc6\u7801"),(0,s.kt)("li",{parentName:"ul"},"'sink.buffer-flush.interval-ms' = '5000'")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f:\u6b64\u6620\u5c04\u8868\u53ea\u80fd\u8fdb\u884c\u6570\u636e\u5bfc\u5165,\u4e0d\u80fd\u626b\u63cf,\u6240\u4ee5\u4e0d\u53ef\u4ee5\u67e5\u8be2.\u5982\u679c\u9700\u8981\u67e5\u8be2\u53ef\u4ee5\u521b\u5efa\u626b\u63cf\u6620\u5c04\u8868,\u914d\u7f6escan-url\u3002")),(0,s.kt)("p",null,"Kafka\u7684dws\u6570\u636e\u5199\u5165\u5230StarRocks\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"BEGIN STATEMENT SET;\n\ninsert into starrocks.starrocks_dws_course_revenue_load\nselect `course_id`, `date`, `total_cnt`, `toatal_money`, `avg`, `stu_course_order_status`\nfrom dw.kafka_dws_course_revenue;\n\ninsert into starrocks.starrocks_dws_overall_revenue_load\nselect `course_id`, `course_name`,`paid_count`,`paid_amount`\nfrom dw.kafka_dws_overall_revenue;\n\nEND;\n")),(0,s.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u7ed3\u679c\u56fe\u7247",src:t(4166).Z,width:"811",height:"446"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u6570\u636e\u4eceMySQL\u4f7f\u7528Flink CDC\u540c\u6b65\u5230kafka\uff0c\u6784\u5efaods\u5c42\uff0c\u7136\u540e\u901a\u8fc7Flink\u628aKafka\u7684ods\u5c42\u6570\u636e\u5bfc\u5165\u5230paimon\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u5bf9\u4e8edim\u5c42\u6570\u636e\uff0c\u76f4\u63a5\u7528Flink CDC\u540c\u6b65\u5230\u4e86paimon\u3002"),(0,s.kt)("li",{parentName:"ul"},"dwd\u6570\u636e\u901a\u8fc7\u5728kafka\u8fdb\u884cods\u6570\u636e\u901a\u8fc7FlinkSQL\u7684join\u64cd\u4f5c\uff0c\u6253\u5bbd\u4ee5\u540e\u5199\u5165\u5230\u4e00\u4e2a\u65b0\u7684topic\u3002"),(0,s.kt)("li",{parentName:"ul"},"dws\u5c42\u6570\u636e\u4e5f\u662f\u76f4\u63a5\u6d88\u8d39kafka\u7684topic\u4f7f\u7528FlinkSQL\u5199\u5165\u5230\u65b0\u7684topic\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u5bf9\u4e8edwd\u6570\u636e\u548cdws\u6570\u636e\uff0c\u4f7f\u7528flink\u5b9e\u65f6\u7684\u628akafka\u7684ods,dwd,dws\u4e0b\u6c89\u5230paimon\u3002"),(0,s.kt)("li",{parentName:"ul"},"\u6700\u540e\u628akafka\u7684dws\u6570\u636e\u901a\u8fc7FlinkSQL\u5199\u5165\u5230StarRocks\uff0c\u7136\u540e\u4f7f\u7528DataV\u62a5\u8868\u5728\u7ebf\u5c55\u793a\u3002")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f\uff1a\u5728\u521b\u5efapaimon catalog\u7684\u65f6\u5019\uff0c\u5bf9\u5e94\u7684oss\u6570\u636e\u5b58\u50a8\uff0c\u8981\u5728\u540c\u4e00\u4e2a\u533a\u57df\u624d\u80fd\u591f\u6b63\u5e38\u5199\u5165\uff0c\u6bd4\u5982flink\u521b\u5efa\u7684\u65f6\u5019\u662f\u5317\u4eac\u533a\u57df\uff0c\u90a3\u4e48oss\u8981\u5317\u4eac\u533a\u57df\u624d\u884c\u3002")))}_.isMDXComponent=!0},51654:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/0a4466e9257f14f370446e87c21ebb7-f1826293ab7d9f767e677e18b71827ec.png"},3293:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/3224f2f74843f5284ac0a3c798e8885-eefc9ba8f0b2bd1123c3a68f55f18705.png"},26160:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/38c87bc1be28cbbe8e8ac24fbf437a2-8d45e3cc3fb5c4689cf44d44661d21b1.png"},4021:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/3fd01e6bbb80685e752478c7677c22b-4fbef63feb52bb663df444a9fb13c626.png"},80942:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/64c2b3abedcb8ca957304fa5b559103-5f8b65dc40d8d3c9fc86327c01b20d69.png"},9494:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/876071ce29356ab4b14136f69d6ecf9-9cc5eb907b678084df5180e489c15c57.png"},46634:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/8ce51f8067f617055a4d8c862654764-67959d45990e76e6967b36a769a208dd.png"},47271:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/96a6d9017207d56f78430dd755a4600-12e5e691320fbf00cf4286c279a7de93.png"},45611:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/a50ea5fec1d102b920f2031f971b514-4d078068f734229aea364c1e300abbd1.png"},53525:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/bfd431553b791fb6fa9aab1c43d4db0-36f5375dbced17d56e63f15ec8d21d84.png"},4166:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/d6e9b6d01ab74efd5d97634cbe633e3-d88c4a549780058465f809f150a549fa.png"},6879:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/d9622bc35aaf6f2d27ae3caa4005916-2677f1ae8bd11c80535d9efb8917d535.png"},58142:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/db2d5c847a30d295eb8ff8935f45360-36a55ec36aacb3320fe09d26be8bfad1.png"},69873:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/ede031b3781e880c905f9700de5cb45-4cf14435d3e18e802657a223b1da2789.png"},7758:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/fef839d627dfacaf615ae90dce77b0d-ff3077b858eade04cf16134e6ffc1033.png"}}]);