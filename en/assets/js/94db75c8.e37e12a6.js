"use strict";(self.webpackChunkathenaserving=self.webpackChunkathenaserving||[]).push([[1398],{3905:(e,l,n)=>{n.d(l,{Zo:()=>c,kt:()=>k});var t=n(67294);function a(e,l,n){return l in e?Object.defineProperty(e,l,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[l]=n,e}function r(e,l){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);l&&(t=t.filter((function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),n.push.apply(n,t)}return n}function o(e){for(var l=1;l<arguments.length;l++){var n=null!=arguments[l]?arguments[l]:{};l%2?r(Object(n),!0).forEach((function(l){a(e,l,n[l])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(n,l))}))}return e}function i(e,l){if(null==e)return{};var n,t,a=function(e,l){if(null==e)return{};var n,t,a={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],l.indexOf(n)>=0||(a[n]=e[n]);return a}(e,l);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],l.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=t.createContext({}),p=function(e){var l=t.useContext(s),n=l;return e&&(n="function"==typeof e?e(l):o(o({},l),e)),n},c=function(e){var l=p(e.components);return t.createElement(s.Provider,{value:l},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var l=e.children;return t.createElement(t.Fragment,{},l)}},m=t.forwardRef((function(e,l){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(n),m=a,k=u["".concat(s,".").concat(m)]||u[m]||d[m]||r;return n?t.createElement(k,o(o({ref:l},c),{},{components:n})):t.createElement(k,o({ref:l},c))}));function k(e,l){var n=arguments,a=l&&l.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var i={};for(var s in l)hasOwnProperty.call(l,s)&&(i[s]=l[s]);i.originalType=e,i[u]="string"==typeof e?e:a,o[1]=i;for(var p=2;p<r;p++)o[p]=n[p];return t.createElement.apply(null,o)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},45591:(e,l,n)=>{n.r(l),n.d(l,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var t=n(87462),a=(n(67294),n(3905));const r={sidebar_position:2,sidebar_label:"\u7b80\u5355\u64cd\u4f5c"},o=void 0,i={unversionedId:"\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u7b80\u5355\u64cd\u4f5c",id:"\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u7b80\u5355\u64cd\u4f5c",title:"\u7b80\u5355\u64cd\u4f5c",description:"\u64cd\u4f5c\u65b9\u5f0f",source:"@site/docs/\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u7b80\u5355\u64cd\u4f5c.md",sourceDirName:"\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible",slug:"/\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u7b80\u5355\u64cd\u4f5c",permalink:"/en/docs/\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u7b80\u5355\u64cd\u4f5c",draft:!1,editUrl:"https://github.com/zhangyongtian/bigdataknowledge/tree/dev/docs/\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u7b80\u5355\u64cd\u4f5c.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"\u7b80\u5355\u64cd\u4f5c"},sidebar:"docSidebar",previous:{title:"\u6982\u8ff0",permalink:"/en/docs/\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u6982\u8ff0"},next:{title:"\u9ad8\u7ea7\u64cd\u4f5c",permalink:"/en/docs/\u81ea\u52a8\u5316\u8fd0\u7ef4/Ansible/\u9ad8\u7ea7\u64cd\u4f5c"}},s={},p=[{value:"\u64cd\u4f5c\u65b9\u5f0f",id:"\u64cd\u4f5c\u65b9\u5f0f",level:2},{value:"Ad-Hoc Commands \u662f\u4ec0\u4e48\uff1f",id:"ad-hoc-commands-\u662f\u4ec0\u4e48",level:3},{value:"Playbooks \u662f\u4ec0\u4e48\uff1f",id:"playbooks-\u662f\u4ec0\u4e48",level:3},{value:"\u6ca1\u6709 Ansible \u65f6\uff0c\u6211\u4eec\u662f\u600e\u4e48\u64cd\u4f5c\u7684\uff1f",id:"\u6ca1\u6709-ansible-\u65f6\u6211\u4eec\u662f\u600e\u4e48\u64cd\u4f5c\u7684",level:3},{value:"\u540e\u8bdd",id:"\u540e\u8bdd",level:2}],c={toc:p},u="wrapper";function d(e){let{components:l,...r}=e;return(0,a.kt)(u,(0,t.Z)({},c,r,{components:l,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u64cd\u4f5c\u65b9\u5f0f"},"\u64cd\u4f5c\u65b9\u5f0f"),(0,a.kt)("p",null,"\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 ",(0,a.kt)("strong",{parentName:"p"},"Ad-Hoc command")," \u548c ",(0,a.kt)("strong",{parentName:"p"},"Playbook")," \u4e24\u79cd\u65b9\u5f0f\u6765\u64cd\u4f5c Ansible\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"adpl",src:n(31470).Z,width:"1024",height:"768"})),(0,a.kt)("p",null,"\u524d\u8005\u662f\u900f\u8fc7\u4e00\u6b21\u6b21\u7b80\u77ed\u7684\u6307\u4ee4\u6765\u64cd\u4f5c Ansible\uff0c\u800c",(0,a.kt)("strong",{parentName:"p"},"\u540e\u8005\u5219\u662f\u5148\u628a\u4efb\u52a1\u5199\u597d\uff0c\u7136\u540e\u518d\u4e00\u6b21\u6267\u884c"),"\u3002\u4e24\u8005\u7684\u5173\u7cfb\u5c31",(0,a.kt)("strong",{parentName:"p"},"\u597d\u6bd4\u6211\u4eec\u5728 Linux Shell \u91cc\u6253\u6307\u4ee4\u548c\u5148\u5199\u4e2a Shell Script \u518d\u6267\u884c\u4e00\u6837"),"\u3002"),(0,a.kt)("h3",{id:"ad-hoc-commands-\u662f\u4ec0\u4e48"},"Ad-Hoc Commands \u662f\u4ec0\u4e48\uff1f"),(0,a.kt)("p",null,"Ad-Hoc Commands \u53ef\u4ee5\u7ffb\u8bd1\u4e3a\u7b80\u77ed\u5730\u6307\u4ee4\uff0c\u5728\u8fd9\u91cc\u51bb\u4ec1\u4f1a\u7528\u6307\u4ee4\u64cd\u4f5c\u6a21\u5f0f\u6765\u5f62\u5bb9\u5b83\uff0c\u4ee5\u5e38\u89c1\u7684 ping \u548c echo \u64cd\u4f5c\u4e3a\u4f8b\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"ping")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ansible -i hosts all -m ping\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'server1 | SUCCESS => {\n    "changed": false,\n    "ping": "pong"\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"echo")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'ansible -i hosts all -m command -a "echo Hello World"\n')),(0,a.kt)("p",null,"\u4ece\u4ee5\u4e0a\u7684\u4f8b\u5b50\u4e2d\u53ef\u4ee5\u770b\u5230 ",(0,a.kt)("strong",{parentName:"p"},"Ad-Hoc commands \u4e00\u6b21\u53ea\u80fd\u5904\u7406\u4e00\u4ef6\u4e8b\u60c5"),"\uff0c\u8fd9\u5373\u662f\u5b83\u4e0e Playbooks \u6700\u5927\u7684\u5dee\u5f02\u3002"),(0,a.kt)("h3",{id:"playbooks-\u662f\u4ec0\u4e48"},"Playbooks \u662f\u4ec0\u4e48\uff1f"),(0,a.kt)("p",null,"\u7b80\u800c\u8a00\u4e4b\uff0cPlaybooks \u662f Ansible \u7684\u811a\u672c (Script)\uff0c\u800c\u4e14\u8fd8\u662f\u4e2a\u6bd4\u4f20\u7edf Shell Script \u8fd8\u5f3a\u5927\u6570\u767e\u500d\u7684\u811a\u672c\uff01\u5982\u679c\u4eca\u5929\u53ea\u80fd\u8bb0\u4f4f\u4e00\u4ef6\u4e8b\uff0c\u8bf7\u8bb0\u4f4f Ansible \u6700\u597d\u7528\u3001\u6700\u5389\u5bb3\u7684\u5c31\u662f\u5b83\u7684 Playbook\uff01"),(0,a.kt)("p",null,"\u5728\u4e00\u4efd Playbook \u4e2d\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a Play\u3001\u591a\u4e2a Task \u548c\u591a\u4e2a Module\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Play\uff1a\u901a\u5e38\u4e3a\u67d0\u4e2a\u7279\u5b9a\u7684\u76ee\u7684\uff0c\u4f8b\u5982\uff1a",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Setup a official website with Drupal")," (\u501f\u7531 Drupal \u5efa\u7f6e\u5b98\u7f51)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Restart the API service")," (\u91cd\u5f00 API \u670d\u52a1)"))),(0,a.kt)("li",{parentName:"ul"},"Task\uff1a\u662f\u8981\u5b9e\u884c Play \u8fd9\u4e2a\u76ee\u5730\u6240\u9700\u505a\u7684\u6bcf\u4e2a\u6b65\u9aa4\uff0c\u4f8b\u5982\uff1a",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Install the Nginx")," (\u5b89\u88dd Nginx)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Kill the djnago process")," (\u5f3a\u5236\u505c\u6b62 django \u7684\u884c\u7a0b)"))),(0,a.kt)("li",{parentName:"ul"},"Module\uff1aAnsible \u6240\u63d0\u4f9b\u7684\u5404\u79cd\u64cd\u4f5c\u65b9\u6cd5\uff0c\u4f8b\u5982\uff1a\n",(0,a.kt)("inlineCode",{parentName:"li"},"-apt: name=vim state=present")," (\u4f7f\u7528 apt \u5957\u4ef6\u5b89\u88c5 vim)\n",(0,a.kt)("inlineCode",{parentName:"li"},"-command: /sbin/shutdown -r now")," (\u4f7f\u7528 shutdown \u7684\u6307\u4ee4\u91cd\u65b0\u5f00\u673a)")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"adpl",src:n(77423).Z,width:"1024",height:"768"})),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Hello World Playbook")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6765\u5199\u4e00\u4e0b\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a playbook\uff01\u8bf7\u5efa\u7acb\u4e00\u4e2a hello_world.yml \u7684\u6863\u6848\uff0c\u5e76\u5c06 --- \u5f00\u59cb\u7684\u5185\u5bb9\u90fd\u5199\u8fdb\u53bb\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"vi hello_world.yml\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"---\n\n- name: say 'hello world'\n  hosts: all\n  tasks:\n\n    - name: echo 'hello world'\n      command: echo 'hello world'\n      register: result\n\n    - name: print stdout\n      debug:\n        msg: \"\"\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6267\u884c playbook\uff1a\u5728\u8fd9\u4e2a\u8303\u4f8b\u4e2d\uff0c\u6211\u4eec\u6267\u884c\u4e86 1 \u4e2a Play\u30013 \u4e2a Task \u548c 2 \u4e2a Module\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ansible-playbook -i hosts hello_world.yml\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"PLAY [say 'hello world'] *******************************************************\n\nTASK [setup] *******************************************************************\nok: [server1]\n\nTASK [echo 'hello world'] ******************************************************\nchanged: [server1]\n\nTASK [print stdout] ************************************************************\nok: [server1] => {\n    \"msg\": \"hello world\"\n}\n\nPLAY RECAP *********************************************************************\nserver1                    : ok=3    changed=1    unreachable=0    failed=0\n")),(0,a.kt)("h3",{id:"\u6ca1\u6709-ansible-\u65f6\u6211\u4eec\u662f\u600e\u4e48\u64cd\u4f5c\u7684"},"\u6ca1\u6709 Ansible \u65f6\uff0c\u6211\u4eec\u662f\u600e\u4e48\u64cd\u4f5c\u7684\uff1f"),(0,a.kt)("p",null,"\u5728\u6b64\u9644\u4e0a Linux Shell \u4e0a\u7684\u4f20\u7edf\u4f5c\u6cd5\uff0c\u6765\u6bd4\u5bf9\u4e24\u8005\u7684\u64cd\u4f5c\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Shell (command line, cli, console)")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"ping")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ ping -c 1 8.8.8.8\nPING 8.8.8.8 (8.8.8.8): 56 data bytes\n64 bytes from 8.8.8.8: icmp_seq=0 ttl=44 time=10.022 ms\n\n--- 8.8.8.8 ping statistics ---\n1 packets transmitted, 1 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 10.022/10.022/10.022/0.000 ms\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"echo")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ echo Hello World\nHello World\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Shell Script")),(0,a.kt)("p",null,"\u5efa\u7acb hello_world.sh \u6863\u6848\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"#!/bin/bash\necho 'Hello World'\n")),(0,a.kt)("p",null,"\u6267\u884c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ bash hello_world.sh\nHello World\n")),(0,a.kt)("h2",{id:"\u540e\u8bdd"},"\u540e\u8bdd"),(0,a.kt)("p",null,"\u5927\u5bb6\u6216\u8bb8\u4f1a\u95ee\uff0c\u4f1a\u5199 script \u5c31\u591f\u7528\u4e86\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u4f1a\u5199 playbook \u5462\uff1f\u5728\u6b64\u5217\u4e86\u51e0\u4e2a\u7406\u7531\u7ed9\u5927\u5bb6\u53c2\u8003\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u82e5\u6709\u73b0\u6210\u7684 script\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 shell module \u6765\u6267\u884c\u5b83\uff0c\u8fd9\u90e8\u4efd\u867d\u4e0d\u51b2\u7a81\uff0c\u4f46\u4f7f\u7528 shell module \u4f1a\u9020\u6210\u6bcf\u6b21\u8dd1 playbook \u90fd\u4f1a\u91cd\u590d\u6267\u884c\uff0c\u4e0d\u50cf\u5176\u5b83 module \u6267\u884c\u8fc7\u5c31\u4e0d\u4f1a\u518d\u6267\u884c\u4e86\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u7528 Ansible \u7684 module \u53ef\u4ee5",(0,a.kt)("strong",{parentName:"li"},"\u628a\u5f88\u591a\u6742\u4e71\u7684\u6307\u4ee4\u7ed9\u6807\u51c6\u5316"),"\uff0c\u4f8b\u5982\u4e0d\u540c\u7684 Linux \u53d1\u884c\u7248\u672c\u5728\u5b89\u88c5\u5957\u4ef6\u65f6\u9700\u4ee3\u5404\u79cd\u4e0d\u540c\u7684\u53c2\u6570\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5728\u73b0\u6709\u7684 cloud native \u7684\u67b6\u6784\u4e0b\uff0c\u4f20\u7edf\u7684 Shell Script \u5df2\u4e0d\u7b26\u4f7f\u7528\uff0c\u4e00\u822c\u800c\u8a00 Shell Script \u53ea\u80fd\u5bf9\u4e00\u53f0\u673a\u5668 (instance) \u8fdb\u884c\u64cd\u4f5c\u3002")),(0,a.kt)("p",null,"\u76f8\u4fe1\u5927\u5bb6\u90fd\u77e5\u9053\u8981\u600e\u4e48\u64cd\u4f5c Ansible \u4e86\uff0c\u597d\u597d\u4eab\u53d7 Ansible \u5e26\u7ed9\u6211\u4eec\u7684\u4e50\u8da3\u5427\uff01"))}d.isMDXComponent=!0},31470:(e,l,n)=>{n.d(l,{Z:()=>t});const t=n.p+"assets/images/ad-d3f100d897b6cc8e90dc8c468572963d.jpg"},77423:(e,l,n)=>{n.d(l,{Z:()=>t});const t=n.p+"assets/images/playbook-167b72628e8337ea8a4b9267d14613f0.gif"}}]);